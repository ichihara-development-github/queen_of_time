{"ast":null,"code":"import _objectSpread from \"/usr/src/app/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/usr/src/app/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/usr/src/app/app/src/components/timestamps/LeavingButton.jsx\";\n\nimport React, { useState, useContext } from \"react\";\nimport Box from '@mui/material/Box';\nimport Button from '@mui/material/Button';\nimport { DefaultModal } from \"../shared/DefaultModal\";\nimport { TimestampMap } from \"./TimestampMap\";\nimport { updateTimestamp } from \"../../apis/timestamp\";\nimport { SnackbarContext } from \"../../contexts/snackBar\";\nexport var LeavingButton = function LeavingButton(_ref) {\n  var checkDistance = _ref.checkDistance,\n      officePosition = _ref.officePosition,\n      style = _ref.style,\n      buttonState = _ref.buttonState,\n      setButtonState = _ref.setButtonState;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      open = _useState2[0],\n      setOpen = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      content = _useState4[0],\n      setContent = _useState4[1];\n\n  var sb = useContext(SnackbarContext); //---------------gps-------------------\n\n  var options = {\n    enableHightAccuracy: true,\n    timeout: 10000\n  };\n\n  var dynamicStyle = _objectSpread({}, style, {\n    backgroundColor: buttonState.lv ? \"\" : \"orange\",\n    color: buttonState.lv ? \"gray\" : \"white\"\n  });\n\n  var success = function success(position) {\n    var coords = position.coords; // if (!checkDistance(coords)){\n    //   return false\n    // }\n\n    var myPosition = {\n      lat: coords.latitude,\n      lng: coords.longitude,\n      zIndex: 1\n    };\n    updateTimestamp({\n      leaving_time: position.timestamp / 1000\n    }).then(function (data) {\n      var content = /*#__PURE__*/React.createElement(\"div\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(TimestampMap, {\n        officePosition: officePosition,\n        myPosition: myPosition,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"h1\", {\n        style: {\n          color: \"orange\"\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 17\n        }\n      }, \"\\u9000\\u3000\\u52E4\"), /*#__PURE__*/React.createElement(\"h5\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 17\n        }\n      }, data.name), /*#__PURE__*/React.createElement(\"p\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 17\n        }\n      }, \"\\u672C\\u65E5\\u3082\\u304A\\u75B2\\u308C\\u69D8\\u3067\\u3057\\u305F\\u3002\"));\n      setContent(content);\n    }).catch(function (e) {\n      return console.log(e.message);\n    });\n  };\n\n  var error = function error(err) {\n    console.error(\"\".concat(err.code, \": \").concat(err.message));\n  }; //---------------------------------------\n\n\n  var handleClick = function handleClick(e) {\n    if (!window.navigator.onLine) {\n      sb.setSnackBar({\n        open: true,\n        variant: \"error\",\n        content: \"インターネットに接続されていません\"\n      });\n      return;\n    }\n\n    setButtonState(_objectSpread({}, buttonState, {\n      lv: true\n    }));\n    navigator.geolocation.getCurrentPosition(success, error, options);\n    setOpen(true);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"button\", {\n    style: dynamicStyle,\n    className: \"stampingButton\",\n    onClick: function onClick(e) {\n      return handleClick(e);\n    },\n    disabled: buttonState.lv,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 3\n    }\n  }, \"\\u9000\\u3000\\u52E4\"), /*#__PURE__*/React.createElement(DefaultModal, {\n    open: open,\n    setOpen: setOpen,\n    content: content,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 5\n    }\n  }));\n};","map":{"version":3,"names":["React","useState","useContext","Box","Button","DefaultModal","TimestampMap","updateTimestamp","SnackbarContext","LeavingButton","checkDistance","officePosition","style","buttonState","setButtonState","open","setOpen","content","setContent","sb","options","enableHightAccuracy","timeout","dynamicStyle","backgroundColor","lv","color","success","position","coords","myPosition","lat","latitude","lng","longitude","zIndex","leaving_time","timestamp","then","data","name","catch","e","console","log","message","error","err","code","handleClick","window","navigator","onLine","setSnackBar","variant","geolocation","getCurrentPosition"],"sources":["/usr/src/app/app/src/components/timestamps/LeavingButton.jsx"],"sourcesContent":["import React, { useState, useContext } from \"react\"\r\n\r\nimport Box from '@mui/material/Box';\r\nimport Button from '@mui/material/Button';\r\nimport { DefaultModal } from \"../shared/DefaultModal\";\r\nimport {TimestampMap} from \"./TimestampMap\"\r\nimport { updateTimestamp } from \"../../apis/timestamp\";\r\nimport { SnackbarContext } from \"../../contexts/snackBar\";\r\n\r\n\r\nexport const LeavingButton = ({\r\n  checkDistance,\r\n  officePosition,\r\n  style,\r\n  buttonState,\r\n  setButtonState\r\n}) => { \r\n\r\n  const [open, setOpen] = useState(false);\r\n  const [content, setContent] =useState(\"\");\r\n  const sb = useContext(SnackbarContext)\r\n\r\n  //---------------gps-------------------\r\n  \r\n  const options = {\r\n    enableHightAccuracy: true,\r\n    timeout: 10000,    \r\n}\r\n\r\n\r\nconst dynamicStyle = {\r\n  ...style,\r\n  backgroundColor: buttonState.lv? \"\":\"orange\" ,\r\n  color:  buttonState.lv? \"gray\" : \"white\"\r\n}\r\n\r\nconst success = (position) => {\r\n    const coords = position.coords\r\n  \r\n      // if (!checkDistance(coords)){\r\n      //   return false\r\n      // }\r\n\r\n      \r\n      const myPosition = {\r\n        lat: coords.latitude,\r\n        lng: coords.longitude,\r\n        zIndex: 1,\r\n      }\r\n            \r\n\r\n      updateTimestamp({leaving_time: (position.timestamp / 1000)})\r\n      .then((data) => {\r\n        \r\n          var content = (\r\n            <div>\r\n                <TimestampMap\r\n                  officePosition={officePosition} \r\n                  myPosition={myPosition}\r\n                />\r\n                <h1 style={{color:\"orange\"}}>退　勤</h1>\r\n                {/* {defaultText(position)} */}\r\n                <h5>{data.name}</h5>\r\n                <p>本日もお疲れ様でした。</p>\r\n            </div>)\r\n        \r\n        setContent(content)\r\n      \r\n    })\r\n      .catch((e) => console.log(e.message))\r\n    }\r\n\r\n\r\n    const error = (err) => {\r\n        console.error(`${err.code}: ${err.message}`);\r\n    }\r\n\r\n    \r\n    //---------------------------------------\r\n\r\n\r\n  \r\n  const handleClick = (e) => {\r\n    if(!window.navigator.onLine){\r\n      sb.setSnackBar({open: true, variant:\"error\", content:\"インターネットに接続されていません\"})\r\n      return\r\n    }\r\n    setButtonState({...buttonState, lv: true})\r\n    navigator.geolocation.getCurrentPosition(success, error, options);\r\n    setOpen(true)\r\n\r\n  }\r\n\r\n\r\n\r\n  return (\r\n\r\n    <>\r\n  <button\r\n    style={dynamicStyle}\r\n    className=\"stampingButton\"\r\n    onClick={(e) => handleClick(e)}\r\n    disabled={buttonState.lv}\r\n    >退　勤\r\n    </button>\r\n\r\n\r\n    <DefaultModal\r\n     open={open} \r\n     setOpen={setOpen} \r\n     content={content} \r\n     />\r\n      \r\n    </>\r\n\r\n    \r\n  )\r\n\r\n\r\n\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}