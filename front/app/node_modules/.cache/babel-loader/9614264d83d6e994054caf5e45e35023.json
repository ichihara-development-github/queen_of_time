{"ast":null,"code":"import AWS from 'aws-sdk';\nimport { sendProfile } from '../apis/config';\nexport var imageUploder = function imageUploder(image, key, sb) {\n  console.log(process.env.REACT_APP_S3_BUCKET);\n  console.log(process.env.REACT_APP_S3_BUCKET_REGION); // aws setting\n\n  AWS.config.update({\n    accessKeyId: process.env.REACT_APP_S3_ACCESS_KEY_ID,\n    secretAccessKey: process.env.REACT_APP_S3_SECRET_ACCESS_KEY\n  });\n  var bucket = new AWS.S3({\n    params: {\n      Bucket: process.env.REACT_APP_S3_BUCKET\n    },\n    region: process.env.REACT_APP_S3_BUCKET_REGION\n  });\n\n  try {\n    var params = {\n      Body: image,\n      Bucket: process.env.REACT_APP_S3_BUCKET,\n      Key: key\n    }; // setUpload(true)\n\n    bucket.putObject(params).promise().then(function (res) {\n      console.log(res.$response);\n\n      if (res.$response.httpResponse.statusCode !== 200) {\n        sb.setSnackBar({\n          open: true,\n          variant: \"error\",\n          content: \"画像のアップロードに失敗しました。\"\n        });\n        return;\n      }\n\n      sendProfile({\n        image_url: key\n      });\n      sb.setSnackBar({\n        open: true,\n        variant: \"success\",\n        content: \"画像のアップロードが正常に行われました。\"\n      });\n    });\n  } catch (e) {\n    throw e;\n  }\n};","map":{"version":3,"names":["AWS","sendProfile","imageUploder","image","key","sb","console","log","process","env","REACT_APP_S3_BUCKET","REACT_APP_S3_BUCKET_REGION","config","update","accessKeyId","REACT_APP_S3_ACCESS_KEY_ID","secretAccessKey","REACT_APP_S3_SECRET_ACCESS_KEY","bucket","S3","params","Bucket","region","Body","Key","putObject","promise","then","res","$response","httpResponse","statusCode","setSnackBar","open","variant","content","image_url","e"],"sources":["/usr/src/app/app/src/lib/imageUploader.js"],"sourcesContent":["import AWS from 'aws-sdk';\r\nimport { sendProfile } from '../apis/config';\r\n\r\n\r\nexport const imageUploder = (image, key, sb) => {\r\n    console.log(process.env.REACT_APP_S3_BUCKET)\r\n    console.log(process.env.REACT_APP_S3_BUCKET_REGION)\r\n\r\n    // aws setting\r\n    AWS.config.update({\r\n        accessKeyId: process.env.REACT_APP_S3_ACCESS_KEY_ID,\r\n        secretAccessKey: process.env.REACT_APP_S3_SECRET_ACCESS_KEY\r\n    })\r\n\r\n\r\n    const bucket = new AWS.S3({\r\n        params: {Bucket: process.env.REACT_APP_S3_BUCKET},\r\n        region: process.env.REACT_APP_S3_BUCKET_REGION\r\n    })\r\n\r\n    try {\r\n        const params = {\r\n            Body: image,\r\n            Bucket:  process.env.REACT_APP_S3_BUCKET,\r\n            Key: key\r\n        }\r\n        \r\n        // setUpload(true)\r\n        bucket.putObject(params).promise()\r\n        .then(res => {\r\n            console.log(res.$response)\r\n            if(res.$response.httpResponse.statusCode !== 200){\r\n                sb.setSnackBar({open: true, variant:\"error\", content: \"画像のアップロードに失敗しました。\"})\r\n                return \r\n            }\r\n            sendProfile({image_url: key})\r\n            sb.setSnackBar({open: true, variant:\"success\", content: \"画像のアップロードが正常に行われました。\"})\r\n        })\r\n        }\r\n        catch(e){ throw e}\r\n    }"],"mappings":"AAAA,OAAOA,GAAP,MAAgB,SAAhB;AACA,SAASC,WAAT,QAA4B,gBAA5B;AAGA,OAAO,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,KAAD,EAAQC,GAAR,EAAaC,EAAb,EAAoB;EAC5CC,OAAO,CAACC,GAAR,CAAYC,OAAO,CAACC,GAAR,CAAYC,mBAAxB;EACAJ,OAAO,CAACC,GAAR,CAAYC,OAAO,CAACC,GAAR,CAAYE,0BAAxB,EAF4C,CAI5C;;EACAX,GAAG,CAACY,MAAJ,CAAWC,MAAX,CAAkB;IACdC,WAAW,EAAEN,OAAO,CAACC,GAAR,CAAYM,0BADX;IAEdC,eAAe,EAAER,OAAO,CAACC,GAAR,CAAYQ;EAFf,CAAlB;EAMA,IAAMC,MAAM,GAAG,IAAIlB,GAAG,CAACmB,EAAR,CAAW;IACtBC,MAAM,EAAE;MAACC,MAAM,EAAEb,OAAO,CAACC,GAAR,CAAYC;IAArB,CADc;IAEtBY,MAAM,EAAEd,OAAO,CAACC,GAAR,CAAYE;EAFE,CAAX,CAAf;;EAKA,IAAI;IACA,IAAMS,MAAM,GAAG;MACXG,IAAI,EAAEpB,KADK;MAEXkB,MAAM,EAAGb,OAAO,CAACC,GAAR,CAAYC,mBAFV;MAGXc,GAAG,EAAEpB;IAHM,CAAf,CADA,CAOA;;IACAc,MAAM,CAACO,SAAP,CAAiBL,MAAjB,EAAyBM,OAAzB,GACCC,IADD,CACM,UAAAC,GAAG,EAAI;MACTtB,OAAO,CAACC,GAAR,CAAYqB,GAAG,CAACC,SAAhB;;MACA,IAAGD,GAAG,CAACC,SAAJ,CAAcC,YAAd,CAA2BC,UAA3B,KAA0C,GAA7C,EAAiD;QAC7C1B,EAAE,CAAC2B,WAAH,CAAe;UAACC,IAAI,EAAE,IAAP;UAAaC,OAAO,EAAC,OAArB;UAA8BC,OAAO,EAAE;QAAvC,CAAf;QACA;MACH;;MACDlC,WAAW,CAAC;QAACmC,SAAS,EAAEhC;MAAZ,CAAD,CAAX;MACAC,EAAE,CAAC2B,WAAH,CAAe;QAACC,IAAI,EAAE,IAAP;QAAaC,OAAO,EAAC,SAArB;QAAgCC,OAAO,EAAE;MAAzC,CAAf;IACH,CATD;EAUC,CAlBL,CAmBI,OAAME,CAAN,EAAQ;IAAE,MAAMA,CAAN;EAAQ;AACrB,CApCE"},"metadata":{},"sourceType":"module"}