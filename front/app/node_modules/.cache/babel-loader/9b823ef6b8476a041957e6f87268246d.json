{"ast":null,"code":"import _objectSpread from \"/usr/src/app/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _toConsumableArray from \"/usr/src/app/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"/usr/src/app/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/usr/src/app/app/src/containers/Notification.jsx\";\n\nimport { Button, Drawer, List, Paper, Skeleton, Typography } from \"@mui/material\";\nimport { Box } from \"@mui/system\";\nimport React, { Fragment, useContext, useEffect, useReducer, useState } from \"react\";\nimport { fetchAllNotifications, fetchNotifications } from \"../apis/notification\";\nimport { STYLE_2 } from \"../components/const\";\nimport { NotificationFeed } from \"../components/notifications/Feed\";\nimport { AuthContext } from \"../contexts/auth\";\nimport { SnackbarContext } from \"../contexts/snackBar\";\nimport { notificationsInitialState, notificationsReducer } from \"../reducers/notifications\";\nexport var Notification = function Notification() {\n  var _useState = useState(0),\n      _useState2 = _slicedToArray(_useState, 2),\n      selected = _useState2[0],\n      setSelected = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var sb = useContext(SnackbarContext);\n  var auth = useContext(AuthContext);\n\n  var _useReducer = useReducer(notificationsReducer, notificationsInitialState),\n      _useReducer2 = _slicedToArray(_useReducer, 2),\n      state = _useReducer2[0],\n      dispatch = _useReducer2[1];\n\n  var drawerWidth = 220;\n\n  var viewAll = function viewAll() {\n    try {\n      dispatch({\n        type: \"FETCHING\"\n      });\n      fetchAllNotifications().then(function (res) {\n        dispatch({\n          type: \"FETCH_END\",\n          payload: res.data.notifications\n        });\n      }).catch(function (e) {\n        if (e.response.status === 403) {\n          auth.sessionForbidden();\n        } else {\n          throw e;\n        }\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  var sortByRead = state.notificationsList.sort(function (a, b) {\n    return Number(a.read) - Number(b.read);\n  });\n  useEffect(function () {\n    try {\n      dispatch({\n        type: \"FETCHING\"\n      });\n      fetchNotifications().then(function (res) {\n        dispatch({\n          type: \"FETCH_END\",\n          payload: res.data.notifications\n        });\n      }).catch(function (e) {\n        if (e.response.status === 403) {\n          auth.sessionForbidden();\n        } else {\n          throw e;\n        }\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  }, []);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Fragment, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Drawer, {\n    variant: \"permanent\",\n    open: true,\n    anchor: \"right\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      width: drawerWidth\n    },\n    role: \"presentation\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 9\n    }\n  }, state.fetchState == \"OK\" ? /*#__PURE__*/React.createElement(React.Fragment, null, state.notificationsList.length > 0 ? /*#__PURE__*/React.createElement(List, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }\n  }, sortByRead.map(function (notification, index) {\n    return /*#__PURE__*/React.createElement(NotificationFeed, {\n      key: index,\n      index: index,\n      notification: notification,\n      selected: selected,\n      setSelected: setSelected,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 15\n      }\n    });\n  })) : /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      p: 1,\n      height: 200\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    component: \"div\",\n    variant: \"subtitle\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 13\n    }\n  }, \"\\u73FE\\u5728\\u901A\\u77E5\\u306F\\u3042\\u308A\\u307E\\u305B\\u3093\"))) : /*#__PURE__*/React.createElement(React.Fragment, null, _toConsumableArray(Array(4).keys()).map(function (i) {\n    return /*#__PURE__*/React.createElement(Box, {\n      key: i,\n      sx: {\n        height: 50\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Typography, {\n      component: \"div\",\n      key: i,\n      variant: \"caption\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Skeleton, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(Skeleton, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 13\n      }\n    })));\n  }))), /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      p: 1\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    id: \"allNotifications\",\n    fullWidth: true,\n    variant: \"outlined\",\n    color: \"primary\",\n    disabled: loading,\n    onClick: function onClick() {\n      return viewAll();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 5\n    }\n  }, \"\\u3059\\u3079\\u3066\\u898B\\u308B\")))), /*#__PURE__*/React.createElement(Paper, {\n    elevation: 3,\n    sx: _objectSpread({\n      width: \"calc(100% - \".concat(drawerWidth, \"px)\"),\n      height: 400\n    }, STYLE_2),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    sx: {\n      p: 2\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 7\n    }\n  }, state.notificationsList.length > 0 && /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 11\n    }\n  }, state.notificationsList[selected].title), /*#__PURE__*/React.createElement(\"h3\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 11\n    }\n  }, \"\\u9001\\u4FE1\\u8005\\uFF1A\\u3000\", state.notificationsList[selected].name), /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 11\n    }\n  }, state.notificationsList[selected].content)))));\n};","map":{"version":3,"names":["Button","Drawer","List","Paper","Skeleton","Typography","Box","React","Fragment","useContext","useEffect","useReducer","useState","fetchAllNotifications","fetchNotifications","STYLE_2","NotificationFeed","AuthContext","SnackbarContext","notificationsInitialState","notificationsReducer","Notification","selected","setSelected","loading","setLoading","sb","auth","state","dispatch","drawerWidth","viewAll","type","then","res","payload","data","notifications","catch","e","response","status","sessionForbidden","console","log","sortByRead","notificationsList","sort","a","b","Number","read","width","fetchState","length","map","notification","index","p","height","Array","keys","i","title","name","content"],"sources":["/usr/src/app/app/src/containers/Notification.jsx"],"sourcesContent":["import { Button, Drawer, List, Paper, Skeleton, Typography} from \"@mui/material\"\r\nimport { Box } from \"@mui/system\"\r\nimport React, { Fragment, useContext, useEffect, useReducer, useState } from \"react\"\r\nimport { fetchAllNotifications, fetchNotifications } from \"../apis/notification\"\r\nimport { STYLE_2 } from \"../components/const\"\r\nimport { NotificationFeed } from \"../components/notifications/Feed\"\r\nimport { AuthContext } from \"../contexts/auth\"\r\nimport { SnackbarContext } from \"../contexts/snackBar\"\r\nimport { notificationsInitialState, notificationsReducer } from \"../reducers/notifications\"\r\n\r\nexport const Notification = () => {\r\n\r\n    const [selected, setSelected] = useState(0);\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const sb = useContext(SnackbarContext);\r\n    const auth = useContext(AuthContext);\r\n\r\n    const [state, dispatch] = useReducer(notificationsReducer, notificationsInitialState)\r\n\r\n    const drawerWidth = 220;\r\n\r\n    const viewAll = () => {\r\n      try{\r\n        dispatch({type: \"FETCHING\"})\r\n        fetchAllNotifications()\r\n        .then(res => {\r\n            dispatch({\r\n              type: \"FETCH_END\",\r\n              payload: res.data.notifications\r\n            })\r\n        })\r\n      .catch(e => {\r\n        if (e.response.status === 403) {\r\n          auth.sessionForbidden()\r\n          } else {\r\n            throw e;\r\n          }\r\n        })\r\n      }\r\n      catch(e){console.log(e)}\r\n    }\r\n\r\n    const sortByRead = state.notificationsList.sort((a,b) =>{\r\n      return (Number(a.read) - Number(b.read))\r\n    })\r\n\r\n\r\n    useEffect(() => {\r\n      try{\r\n        dispatch({type: \"FETCHING\"})\r\n        fetchNotifications()\r\n        .then(res => {\r\n            dispatch({\r\n              type: \"FETCH_END\",\r\n              payload: res.data.notifications\r\n            })\r\n        })\r\n        .catch(e => {\r\n        if (e.response.status === 403) {\r\n          auth.sessionForbidden()\r\n         } else {\r\n           throw e;\r\n         }\r\n        })\r\n      }\r\n      catch(e){console.log(e)}\r\n     \r\n    },[])\r\n\r\n    \r\nreturn (\r\n    <>\r\n      <Fragment>\r\n        <Drawer\r\n          variant=\"permanent\"\r\n          open={true}\r\n          anchor=\"right\"\r\n        >\r\n        <Box\r\n        sx={{ width:drawerWidth}}\r\n        role=\"presentation\"\r\n        >\r\n                       \r\n    {state.fetchState == \"OK\" ?\r\n    <>\r\n        {state.notificationsList.length > 0 ?\r\n        <List>\r\n          {sortByRead.map((notification, index) => (\r\n              <NotificationFeed \r\n                key={index}\r\n                index={index} \r\n                notification={notification}\r\n                selected={selected}\r\n                setSelected={setSelected}\r\n               \r\n              />\r\n          ))}\r\n        </List>\r\n        :\r\n          <Box sx={{ p:1, height:200 }}>\r\n            <Typography component=\"div\" variant=\"subtitle\">\r\n              現在通知はありません\r\n            </Typography>\r\n          </Box>\r\n        }\r\n    </>\r\n    :  \r\n    <>\r\n     {\r\n      [...Array(4).keys()].map(i => \r\n        <Box key={i} sx={{ height:50 }}>\r\n          <Typography component=\"div\" key={i} variant=\"caption\">\r\n            <Skeleton />\r\n            <Skeleton />\r\n          </Typography>\r\n        </Box>\r\n      )\r\n     }\r\n    \r\n    </>\r\n    }\r\n   \r\n    </Box>\r\n    <Box sx={{p:1}}>\r\n    <Button \r\n      id=\"allNotifications\"\r\n      fullWidth \r\n      variant=\"outlined\" \r\n      color=\"primary\"\r\n      disabled={loading}\r\n      onClick={() => viewAll()}\r\n       >すべて見る</Button>\r\n      \r\n    </Box>\r\n  \r\n    </Drawer>\r\n  </Fragment>\r\n  <Paper elevation={3} sx={{width: `calc(100% - ${drawerWidth}px)`, height: 400, ...STYLE_2}}>\r\n      <Box sx={{p: 2}}>\r\n                    \r\n    {state.notificationsList.length > 0 &&\r\n      <div>\r\n          <h2>{state.notificationsList[selected].title}</h2>\r\n          <h3>送信者：　{state.notificationsList[selected].name}</h3>\r\n          <div>{state.notificationsList[selected].content}</div>\r\n      </div>\r\n    }\r\n      </Box>\r\n  </Paper>\r\n   \r\n</>\r\n)\r\n\r\n\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}