{"ast":null,"code":"import _objectSpread from \"/usr/src/app/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/usr/src/app/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/usr/src/app/app/src/containers/Shift.jsx\";\n\nimport { Button, CircularProgress } from \"@mui/material\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport { deleteShift, determineShifts, fetchSubmittedShifts } from \"../apis/shifts\";\nimport { PageLoadingCircle } from \"../components/shared/commonPatrs\";\nimport { BadgeContext } from \"../contexts/badge\";\nimport { SnackbarContext } from '../contexts/snackBar';\nimport { ShiftEdit } from \"./ShiftEdit\";\nexport var Shift = function Shift() {\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      value = _useState2[0],\n      setValue = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var sb = useContext(SnackbarContext);\n  var badge = useContext(BadgeContext);\n\n  var undo = function undo() {\n    fetchSubmittedShifts().then(function (res) {\n      return setValue(res.data.shifts);\n    });\n  };\n\n  var updateShifts = function updateShifts(params) {\n    setLoading(true);\n    determineShifts(params).then(function (res) {\n      if (res.status !== 200) {\n        return sb.setSnackBar({\n          open: true,\n          variant: \"error\",\n          content: \"シフトを確定できませんでした。\"\n        });\n      }\n\n      setValue(res.data.shifts);\n      sb.setSnackBar({\n        open: true,\n        variant: \"success\",\n        content: \"シフトを確定しました。\"\n      });\n      badge.setBadge(_objectSpread({}, badge.badge, {\n        shift: res.data.shifts.filter(function (elm) {\n          return elm.confirmed == false;\n        }).length\n      }));\n    });\n    setLoading(false);\n  };\n\n  var unassignShift = function unassignShift(id) {\n    setLoading(true);\n    deleteShift(id).then(function (res) {\n      if (res.status !== 200) {\n        sb.setSnackBar({\n          open: true,\n          color: \"error\",\n          content: \"エラーが発生しました。\"\n        });\n        return;\n      }\n\n      setValue(res.data.shifts);\n      sb.setSnackBar({\n        open: true,\n        color: \"success\",\n        content: \"シフトの削除が成功しましtた。\"\n      });\n    });\n    setLoading(false);\n  };\n\n  useEffect(function () {\n    try {\n      fetchSubmittedShifts().then(function (res) {\n        setValue(res.data.shifts);\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  }, []);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, value ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(ShiftEdit, {\n    value: value,\n    loading: loading,\n    setLoading: setLoading,\n    undo: undo,\n    updateShifts: updateShifts,\n    unassignShift: unassignShift,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }\n  })) : /*#__PURE__*/React.createElement(PageLoadingCircle, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 5\n    }\n  }));\n};","map":{"version":3,"names":["Button","CircularProgress","React","useEffect","useState","useContext","deleteShift","determineShifts","fetchSubmittedShifts","PageLoadingCircle","BadgeContext","SnackbarContext","ShiftEdit","Shift","value","setValue","loading","setLoading","sb","badge","undo","then","res","data","shifts","updateShifts","params","status","setSnackBar","open","variant","content","setBadge","shift","filter","elm","confirmed","length","unassignShift","id","color","e","console","log"],"sources":["/usr/src/app/app/src/containers/Shift.jsx"],"sourcesContent":["import { Button, CircularProgress } from \"@mui/material\";\r\nimport React, { useEffect, useState, useContext } from \"react\";\r\nimport { deleteShift, determineShifts, fetchSubmittedShifts } from \"../apis/shifts\";\r\nimport { PageLoadingCircle } from \"../components/shared/commonPatrs\";\r\nimport { BadgeContext } from \"../contexts/badge\";\r\nimport { SnackbarContext } from '../contexts/snackBar';\r\nimport { ShiftEdit } from \"./ShiftEdit\";\r\n\r\nexport const Shift = () => {\r\n\r\nconst [value, setValue] = useState();\r\nconst [loading, setLoading] = useState(false)\r\nconst sb = useContext(SnackbarContext);\r\nconst badge = useContext(BadgeContext);\r\n\r\n\r\nconst undo = () => {\r\n  fetchSubmittedShifts()\r\n  .then(res =>  setValue(res.data.shifts))\r\n}\r\n\r\n  \r\nconst updateShifts = (params) => {\r\n  setLoading(true)\r\n  determineShifts(params)\r\n  .then(res => {\r\n        if(res.status !== 200){ return sb.setSnackBar({open: true, variant:\"error\",content:\"シフトを確定できませんでした。\"}) }\r\n        setValue(res.data.shifts)\r\n        sb.setSnackBar({open: true, variant:\"success\",content:\"シフトを確定しました。\"})\r\n        badge.setBadge({\r\n          ...badge.badge, shift: res.data.shifts.filter(elm => elm.confirmed == false).length\r\n        })\r\n  })\r\n  setLoading(false)\r\n}\r\n\r\n\r\n  const  unassignShift = (id) => {\r\n    setLoading(true)\r\n    deleteShift(id)\r\n    .then(res => {\r\n      if(res.status !== 200){\r\n        sb.setSnackBar({open: true, color:\"error\",content:\"エラーが発生しました。\"})\r\n        return\r\n      }\r\n      setValue(res.data.shifts)\r\n      sb.setSnackBar({open: true, color:\"success\",content:\"シフトの削除が成功しましtた。\"})\r\n    })\r\n    setLoading(false)\r\n\r\n  }\r\n\r\n\r\n\r\n\r\nuseEffect(() => {\r\n  try {\r\n      fetchSubmittedShifts()\r\n      .then((res) => {\r\n      setValue(res.data.shifts)\r\n})\r\n} \r\ncatch(e){\r\n  console.log(e)\r\n}\r\n\r\n},[])\r\n\r\n  return (\r\n    <>\r\n    {\r\n    value ?\r\n\r\n    <div>\r\n      <ShiftEdit\r\n        value={value}\r\n        loading={loading}\r\n        setLoading={setLoading}\r\n        undo={undo}\r\n        updateShifts={updateShifts}\r\n        unassignShift={unassignShift}\r\n      />\r\n    </div>\r\n    :\r\n    <PageLoadingCircle />\r\n  \r\n}\r\n\r\n    </>\r\n    \r\n\r\n  )\r\n\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}