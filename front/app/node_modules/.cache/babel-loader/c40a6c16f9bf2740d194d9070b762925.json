{"ast":null,"code":"import _objectSpread from \"/usr/src/app/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/usr/src/app/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/usr/src/app/app/src/containers/Shift.jsx\";\n\nimport { Button, CircularProgress } from \"@mui/material\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport { deleteShift, determineShifts, fetchSubmittedShifts } from \"../apis/shifts\";\nimport { PageLoadingCircle } from \"../components/shared/commonPatrs\";\nimport { BadgeContext } from \"../contexts/badge\";\nimport { SnackbarContext } from '../contexts/snackBar';\nimport Paper from '@material-ui/core/Paper';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TablePagination from '@material-ui/core/TablePagination';\nimport TableRow from '@material-ui/core/TableRow';\nimport { myShifts } from '../urls/urlList';\nimport { set } from 'react-hook-form';\nimport { ShiftEdit } from \"./ShiftEdit\";\nexport var Shift = function Shift() {\n  var today = new Date();\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      value = _useState2[0],\n      setValue = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var sb = useContext(SnackbarContext);\n  var badge = useContext(BadgeContext);\n  var selectedDate = useState(today);\n\n  var undo = function undo() {\n    fetchSubmittedShifts().then(function (res) {\n      return setValue(res.data.shifts);\n    });\n  };\n\n  var updateShifts = function updateShifts(params) {\n    setLoading(true);\n    determineShifts(params).then(function (res) {\n      if (res.status !== 200) {\n        return sb.setSnackBar({\n          open: true,\n          variant: \"error\",\n          content: \"シフトを確定できませんでした。\"\n        });\n      }\n\n      setValue(res.data.shifts);\n      sb.setSnackBar({\n        open: true,\n        variant: \"success\",\n        content: \"シフトを確定しました。\"\n      });\n      badge.setBadge(_objectSpread({}, badge.badge, {\n        shift: res.data.shifts.filter(function (elm) {\n          return elm.confirmed == false;\n        }).length\n      }));\n    });\n    setLoading(false);\n  };\n\n  var renderMonth = function renderMonth(date) {\n    var month = [];\n    var lastDay = new Date(date.getFullYear(), date.getMonth() + 1, 0);\n\n    for (var i = 1; i <= lastDay.getDate(); i++) {\n      var targetDay = new Date(date.getFullYear(), date.getMonth(), i);\n      month.push({\n        id: i,\n        label: targetDay.getDate().toString() + \"(\".concat(dayOfWeek[targetDay.getDay()], \")\"),\n        minWidth: 70\n      });\n    }\n\n    return month;\n  };\n\n  useEffect(function () {\n    try {\n      fetchSubmittedShifts().then(function (res) {\n        setValue(res.data.shifts);\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  }, []);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, value ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(TableContainer, {\n    style: {\n      maxHeight: 400\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Table, {\n    stickyHeader: true,\n    \"aria-label\": \"sticky table\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(TableHead, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(TableRow, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }\n  }, renderMonth(selectedDate).map(function (column) {\n    return /*#__PURE__*/React.createElement(TableCell, {\n      key: column.id,\n      style: {\n        minWidth: column.minWidth\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }\n    }, column.label);\n  }))), /*#__PURE__*/React.createElement(TableBody, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 11\n    }\n  }, collectShift(state).map(function (row, i) {\n    return /*#__PURE__*/React.createElement(TableRow, {\n      key: i,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(TableCell, {\n      key: row.employee_id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 15\n      }\n    }), row.map(function (elm) {\n      return /*#__PURE__*/React.createElement(TableCell, {\n        key: elm.id,\n        style: {\n          minWidth: 80\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 17\n        }\n      }, elm.attendance_time, \"-\", elm.leaving_time);\n    }));\n  }))))) : /*#__PURE__*/React.createElement(PageLoadingCircle, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 5\n    }\n  }));\n};","map":{"version":3,"names":["Button","CircularProgress","React","useEffect","useState","useContext","deleteShift","determineShifts","fetchSubmittedShifts","PageLoadingCircle","BadgeContext","SnackbarContext","Paper","Table","TableBody","TableCell","TableContainer","TableHead","TablePagination","TableRow","myShifts","set","ShiftEdit","Shift","today","Date","value","setValue","loading","setLoading","sb","badge","selectedDate","undo","then","res","data","shifts","updateShifts","params","status","setSnackBar","open","variant","content","setBadge","shift","filter","elm","confirmed","length","renderMonth","date","month","lastDay","getFullYear","getMonth","i","getDate","targetDay","push","id","label","toString","dayOfWeek","getDay","minWidth","e","console","log","maxHeight","map","column","collectShift","state","row","employee_id","attendance_time","leaving_time"],"sources":["/usr/src/app/app/src/containers/Shift.jsx"],"sourcesContent":["import { Button, CircularProgress } from \"@mui/material\";\r\nimport React, { useEffect, useState, useContext } from \"react\";\r\nimport { deleteShift, determineShifts, fetchSubmittedShifts } from \"../apis/shifts\";\r\nimport { PageLoadingCircle } from \"../components/shared/commonPatrs\";\r\nimport { BadgeContext } from \"../contexts/badge\";\r\nimport { SnackbarContext } from '../contexts/snackBar';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TablePagination from '@material-ui/core/TablePagination';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport { myShifts } from '../urls/urlList';\r\nimport { set } from 'react-hook-form';\r\n\r\n\r\nimport { ShiftEdit } from \"./ShiftEdit\";\r\n\r\nexport const Shift = () => {\r\n\r\n  \r\nconst today = new Date();\r\n\r\nconst [value, setValue] = useState();\r\nconst [loading, setLoading] = useState(false)\r\nconst sb = useContext(SnackbarContext);\r\nconst badge = useContext(BadgeContext);\r\nconst selectedDate = useState(today);\r\n\r\nconst undo = () => {\r\n  fetchSubmittedShifts()\r\n  .then(res =>  setValue(res.data.shifts))\r\n}\r\n\r\n  \r\nconst updateShifts = (params) => {\r\n  setLoading(true)\r\n  determineShifts(params)\r\n  .then(res => {\r\n        if(res.status !== 200){ return sb.setSnackBar({open: true, variant:\"error\",content:\"シフトを確定できませんでした。\"}) }\r\n        setValue(res.data.shifts)\r\n        sb.setSnackBar({open: true, variant:\"success\",content:\"シフトを確定しました。\"})\r\n        badge.setBadge({\r\n          ...badge.badge, shift: res.data.shifts.filter(elm => elm.confirmed == false).length\r\n        })\r\n  })\r\n  setLoading(false)\r\n}\r\n\r\nconst renderMonth = (date) => {\r\n  const month = [];\r\n  const lastDay = new Date(date.getFullYear(), date.getMonth()+1,0);\r\n  for(let i=1;i<=lastDay.getDate();i++){\r\n    const targetDay = new Date(date.getFullYear(), date.getMonth(),i);\r\n    month.push(\r\n      {id: i,\r\n      label: targetDay.getDate().toString()+`(${dayOfWeek[targetDay.getDay()]})`,\r\n      minWidth: 70\r\n      }\r\n    )\r\n  }\r\n\r\n  return month;\r\n\r\n}\r\n\r\n\r\nuseEffect(() => {\r\n  try {\r\n      fetchSubmittedShifts()\r\n      .then((res) => {\r\n      setValue(res.data.shifts)\r\n})\r\n} \r\ncatch(e){\r\n  console.log(e)\r\n}\r\n\r\n},[])\r\n\r\n  return (\r\n    <>\r\n    {\r\n    value ?\r\n\r\n    <div>\r\n      <TableContainer style={{maxHeight: 400}}>\r\n            <Table stickyHeader aria-label=\"sticky table\">\r\n          <TableHead>\r\n            <TableRow>\r\n              {renderMonth(selectedDate).map(column => (\r\n                <TableCell\r\n                  key={column.id}\r\n                  style={{ minWidth: column.minWidth }}\r\n                >\r\n                  {column.label}\r\n                </TableCell>\r\n              ))}\r\n            </TableRow>\r\n          </TableHead>\r\n          <TableBody>\r\n          {\r\n          collectShift(state).map((row,i) => (\r\n            <TableRow key={i}>\r\n              <TableCell\r\n                  key={row.employee_id}\r\n                >\r\n                </TableCell>\r\n             {row.map(elm => (\r\n                <TableCell\r\n                  key={elm.id}\r\n                  style={{minWidth: 80}}\r\n                >\r\n                  {elm.attendance_time}-{elm.leaving_time}\r\n                </TableCell>\r\n              ))}  \r\n            </TableRow>\r\n          )\r\n            )\r\n          }\r\n        </TableBody>\r\n        </Table>\r\n        </TableContainer>\r\n      {/* <ShiftEdit\r\n        value={value}\r\n        loading={loading}\r\n        setLoading={setLoading}\r\n        undo={undo}\r\n        updateShifts={updateShifts}\r\n        unassignShift={unassignShift}\r\n      /> */}\r\n    </div>\r\n    :\r\n    <PageLoadingCircle />\r\n  \r\n}\r\n\r\n    </>\r\n    \r\n\r\n  )\r\n\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}