{"ast":null,"code":"import _toConsumableArray from \"/usr/src/app/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"/usr/src/app/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectDestructuringEmpty from \"/usr/src/app/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty\";\n\nvar _this = this,\n    _jsxFileName = \"/usr/src/app/app/src/containers/ManageAttendance.jsx\";\n\nimport React, { useEffect, useReducer, useState, useContext, useMemo } from \"react\";\nimport { Button, CircularProgress, List, Stack, Switch, Typography } from \"@mui/material\";\nimport { AttendanceReducer, initialState } from \"../reducers/attendances\";\nimport { AttendanceGraph } from \"../components/attendances/AttendanceGraph\";\nimport { approveRequest, fetchManageAttendance } from \"../apis/attendance\";\nimport { SelectDate } from \"../components/shared/SelectDate\";\nimport { BadgeContext } from \"../contexts/badge\";\nimport { SnackbarContext } from \"../contexts/snackBar\";\nimport { Box } from \"@mui/system\";\nvar SCALE = 4;\nexport var ManageAttendance = function ManageAttendance(_ref) {\n  _objectDestructuringEmpty(_ref);\n\n  //----------------------state----------------\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      checked = _useState2[0],\n      setChecked = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      filter = _useState4[0],\n      setFilter = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      loading = _useState6[0],\n      setLoading = _useState6[1];\n\n  var _useReducer = useReducer(AttendanceReducer, initialState),\n      _useReducer2 = _slicedToArray(_useReducer, 2),\n      state = _useReducer2[0],\n      dispatch = _useReducer2[1];\n\n  var sb = useContext(SnackbarContext);\n  var badge = useContext(BadgeContext);\n\n  var handleCheck = function handleCheck(e) {\n    if (e.target.checked) {\n      setChecked([].concat(_toConsumableArray(checked), [{\n        id: e.target.id,\n        name: e.target.name\n      }]));\n    } else {\n      var filtered = checked.filter(function (elm) {\n        return elm.id != e.target.id;\n      });\n      setChecked(filtered);\n    }\n  };\n\n  var approveTimecard = function approveTimecard() {\n    setLoading(true);\n    var ids = checked.map(function (elm) {\n      return elm.id;\n    });\n\n    try {\n      approveRequest(ids).then(function (res) {\n        if (res.status !== 200) {\n          sb.setSnackBar({\n            variant: \"error\",\n            content: \"承認できませんでした\",\n            open: true\n          });\n          setLoading(false);\n          return;\n        }\n\n        dispatch({\n          type: \"FETCH_END\",\n          payload: res.data.attendances\n        });\n        sb.setSnackBar({\n          variant: \"success\",\n          content: \"勤怠を承認しました\",\n          open: true\n        });\n        setLoading(false);\n      });\n    } catch (e) {\n      console.log(e.message);\n    }\n  };\n\n  useEffect(function () {\n    try {\n      dispatch({\n        type: \"FETCHING\"\n      });\n      fetchManageAttendance().then(function (res) {\n        dispatch({\n          type: \"FETCH_END\",\n          payload: res.data.attendances\n        });\n      });\n    } catch (e) {\n      console.log(e.message);\n    }\n  }, []);\n  return useMemo(function () {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        height: 450,\n        width: '95%'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Stack, {\n      sx: {\n        my: 1\n      },\n      direction: \"row\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }\n    }, filter ? \"\" : /*#__PURE__*/React.createElement(SelectDate, {\n      list: state.attendanceData,\n      setList: dispatch,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(Box, {\n      style: {\n        marginLeft: \"auto\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Stack, {\n      direction: \"row\",\n      alignItems: \"center\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Switch, {\n      checked: filter,\n      onChange: function onChange() {\n        return setFilter(!filter);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(Typography, {\n      variant: \"subtitle1\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 13\n      }\n    }, \"\\u672A\\u627F\\u8A8D\\u306E\\u307F\"), /*#__PURE__*/React.createElement(Button, {\n      style: {\n        marginLeft: \"auto\"\n      },\n      variant: \"contained\",\n      color: \"success\",\n      disabled: checked.length == 0 || loading,\n      onClick: function onClick() {\n        if (window.confirm(\"選択中の勤怠を承認しますか？\")) {\n          approveTimecard();\n        }\n      },\n      endIcon: loading ? /*#__PURE__*/React.createElement(CircularProgress, {\n        sx: {\n          width: \"1rem\",\n          height: \"1rem\"\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 32\n        }\n      }) : \"\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 13\n      }\n    }, \"\\u3000\\u3000\\u3000\\u627F\\u3000\\u8A8D\\u3000\\u3000\\u3000\")))), /*#__PURE__*/React.createElement(AttendanceGraph, {\n      state: state.fetchState,\n      list: filter ? state.attendanceData.filter(function (l) {\n        return !l.confirmed;\n      }) : state.attendanceData,\n      handleCheck: handleCheck,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 11\n      }\n    })));\n  }, [list]);\n};","map":{"version":3,"names":["React","useEffect","useReducer","useState","useContext","useMemo","Button","CircularProgress","List","Stack","Switch","Typography","AttendanceReducer","initialState","AttendanceGraph","approveRequest","fetchManageAttendance","SelectDate","BadgeContext","SnackbarContext","Box","SCALE","ManageAttendance","checked","setChecked","filter","setFilter","loading","setLoading","state","dispatch","sb","badge","handleCheck","e","target","id","name","filtered","elm","approveTimecard","ids","map","then","res","status","setSnackBar","variant","content","open","type","payload","data","attendances","console","log","message","height","width","my","attendanceData","marginLeft","length","window","confirm","fetchState","l","confirmed","list"],"sources":["/usr/src/app/app/src/containers/ManageAttendance.jsx"],"sourcesContent":["import React, { useEffect, useReducer, useState, useContext, useMemo } from \"react\"\r\n\r\nimport { Button, CircularProgress, List, Stack, Switch, Typography } from \"@mui/material\";\r\nimport { AttendanceReducer, initialState } from \"../reducers/attendances\";\r\nimport { AttendanceGraph } from \"../components/attendances/AttendanceGraph\";\r\nimport { approveRequest, fetchManageAttendance } from \"../apis/attendance\";\r\nimport { SelectDate } from \"../components/shared/SelectDate\";\r\nimport { BadgeContext } from \"../contexts/badge\";\r\nimport { SnackbarContext } from \"../contexts/snackBar\";\r\nimport { Box } from \"@mui/system\";\r\n\r\nconst SCALE = 4;\r\n\r\n\r\nexport const ManageAttendance = ({\r\n \r\n}) => {\r\n\r\n  //----------------------state----------------\r\n\r\nconst [checked, setChecked]= useState([]);\r\nconst [filter, setFilter] = useState(false);\r\nconst [loading, setLoading] = useState(false);\r\n\r\nconst [state, dispatch] = useReducer(AttendanceReducer, initialState);\r\nconst sb = useContext(SnackbarContext)\r\nconst badge = useContext(BadgeContext)\r\n\r\nconst handleCheck = (e) => {\r\n    \r\n  if (e.target.checked){\r\n    setChecked([...checked,\r\n    {id: e.target.id,\r\n    name: e.target.name}])\r\n \r\n  }else{\r\n    var filtered = checked.filter(elm => {\r\n      return elm.id != e.target.id\r\n    })\r\n    setChecked(filtered)\r\n  } \r\n} \r\n\r\n\r\nconst approveTimecard = () => {\r\n  setLoading(true)\r\n  var ids = checked.map(elm => elm.id)\r\n  try {\r\n    approveRequest(ids)\r\n    .then(res => {\r\n      if(res.status !== 200){\r\n        sb.setSnackBar({variant: \"error\", content: \"承認できませんでした\", open: true})\r\n        setLoading(false)\r\n        return\r\n      }\r\n      dispatch({type: \"FETCH_END\",\r\n      payload: res.data.attendances\r\n    })\r\n      sb.setSnackBar({variant: \"success\", content: \"勤怠を承認しました\", open: true})\r\n      setLoading(false)\r\n    }\r\n      )\r\n  }catch (e){\r\n    console.log(e.message);\r\n  }\r\n\r\n}\r\n\r\n\r\n  useEffect(() => {\r\n    try {\r\n      dispatch({type: \"FETCHING\"});\r\n      fetchManageAttendance()\r\n      .then((res) => {\r\n      dispatch({type: \"FETCH_END\",\r\n      payload: res.data.attendances\r\n    })\r\n  })\r\n    }catch (e){\r\n      console.log(e.message);\r\n    }\r\n  },[]);\r\n\r\n  return useMemo(() => {\r\n\r\n  return(\r\n      <>      \r\n      <div style={{ height: 450, width: '95%' }}>\r\n        <Stack sx={{my:1}} direction=\"row\">\r\n        {filter ? \r\n          \"\"\r\n          :\r\n            <SelectDate \r\n            list={state.attendanceData}\r\n            setList={dispatch}\r\n            />\r\n        }\r\n\r\n        <Box  style={{marginLeft:\"auto\"}}>\r\n        <Stack direction=\"row\" alignItems=\"center\">\r\n            <Switch\r\n              checked={filter}\r\n              onChange={() => setFilter(!filter)}\r\n            />\r\n            <Typography variant=\"subtitle1\">未承認のみ</Typography>\r\n            <Button \r\n            style={{marginLeft:\"auto\"}}\r\n            variant=\"contained\" \r\n            color=\"success\"\r\n            disabled={(checked.length == 0 || loading)}\r\n            onClick={() => \r\n              {if (window.confirm(\"選択中の勤怠を承認しますか？\"))\r\n              {approveTimecard()}\r\n            }}\r\n            endIcon={loading ? <CircularProgress sx={{width: \"1rem\", height: \"1rem\"}} />:\"\"}\r\n            >\r\n            　　　承　認　　　\r\n        </Button>\r\n          </Stack>\r\n          \r\n\r\n        </Box>\r\n\r\n        </Stack>\r\n          <AttendanceGraph \r\n            state={state.fetchState} \r\n            list={filter ? state.attendanceData.filter(l => !l.confirmed) : state.attendanceData}\r\n            handleCheck={handleCheck}\r\n          />\r\n\r\n      </div>\r\n\r\n      \r\n      </>\r\n\r\n    )\r\n  },[list])\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}